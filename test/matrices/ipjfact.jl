# constructors
@test allequal([
    Ipjfact(5),
    Ipjfact(5, 0),
    Ipjfact{Int}(5),
    Ipjfact{Int}(5, 0),
])

# linear algebra functions
run_test_linear_algebra_functions(Ipjfact.(1:5))
run_test_properties(Ipjfact, 3:5)

# eltype
@test test_matrix_elements(Ipjfact{Int32}(5))
@test test_matrix_elements(Ipjfact{Float32}(5, 1))

# content
@test Ipjfact(5) ≈ Ipjfact(5, 0) ≈ [2 6 24 120 720; 6 24 120 720 5040; 24 120 720 5040 40320; 120 720 5040 40320 362880; 720 5040 40320 362880 3628800]
@test Ipjfact{Float64}(5, 1) ≈ [0.5 0.16666666666666666 0.041666666666666664 0.008333333333333333 0.001388888888888889; 0.16666666666666666 0.041666666666666664 0.008333333333333333 0.001388888888888889 0.0001984126984126984; 0.041666666666666664 0.008333333333333333 0.001388888888888889 0.0001984126984126984 2.48015873015873e-5; 0.008333333333333333 0.001388888888888889 0.0001984126984126984 2.48015873015873e-5 2.7557319223985893e-6; 0.001388888888888889 0.0001984126984126984 2.48015873015873e-5 2.7557319223985893e-6 2.755731922398589e-7]
